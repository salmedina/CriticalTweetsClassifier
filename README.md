# Critical Tweets Classifier

This project is a work on detecting tweets that require an action from first responders or the government during an emerging crisis, such as a natural disaster or an attack. We use a domain-adaptation technique between
different events, by adversarially training a classifier removing the importance on the event per se, allowing the trained model to focus on the criticality of the tweet.

### Data

- [BERT Embeddings of dataset (json)](https://drive.google.com/file/d/1KsenF_qhRsKk67NbSKz9ESYNqtClYngQ/view?usp=sharing)
- [BERT Embeddings of dataset (npy)](https://drive.google.com/file/d/1DqNa49IurhF7OFqMdPYC5acq-zbkGbtU/view?usp=sharing)

### Dependencies

```
pip install easydict
pip install pytorch-revgrad
pip install bert-embedding
pip install pyyaml
pip install pytorch-transformers
```

### Partial Results

#### Earthquake experiment 1
##### Data Split

train:
 - 2015_Nepal_Earthquake_en
 - 2014_Chile_Earthquake_en
 - 2012_Costa_Rica_earthquake
 - 2012_Guatemala_earthquake
 
valid:
 - 2012_Italy_earthquakes

##### Results
|       Model       |    Acc   | Macro F1 | Epoch |                                                                Critical Metrics                                                                |
|:-----------------:|:--------:|:--------:|:-----:|:----------------------------------------------------------------------------------------------------------------------------------------------:|
|    Baseline-GloVe | 0.830357 | 0.644277 |   21  |   {'low': [0.8529403402545683, 0.9560429054473566, 0.901503635067761], 'high': [0.5999940000599994, 0.2857129251765468, 0.38705057718924907]}  |
|     Baseline-BERT | 0.803571 | 0.576585 |   11  |   {'low': [0.8349506456789848, 0.9450539065341687, 0.8865472182306581], 'high': [0.4444395062277086, 0.19047528345103118, 0.266622895408111]}  |
|   Multitask-GloVe | 0.812500 | 0.660015 |   19  | {'low': [0.8645824327266326, 0.9120869097946046, 0.8876496239059914], 'high': [0.49999687501953116, 0.38095056690206236, 0.43238101360925524]} |
|    Mulittask-BERT | 0.803571 | 0.521326 |   11  |  {'low': [0.8224291379166935, 0.9670319043605446, 0.8888383202946046], 'high': [0.3999920001599968, 0.09523764172551559, 0.15381391131490188]} |
| Adversarial-GloVe | 0.812500 | 0.644394 |   24  |   {'low': [0.8571419825081811, 0.9230759087077925, 0.8888380196583165], 'high': [0.4999964285969386, 0.3333317460393046, 0.3999497200352658]}  |
|  Adversarial-BERT | 0.839286 | 0.579963 |   6   |   {'low': [0.8348616193930097, 0.9999989011001087, 0.909949497702883], 'high': [0.9999666677777408, 0.1428564625882734, 0.2499760431292765]}   |                                        |

- Fine-tuned Adversarial BERT

| Learning Rate | Weight Decay | Momentum |    F1    |       Crit F1       |
|:-------------:|:------------:|:--------:|:--------:|:-------------------:|
|    0.086189   |   0.012114   | 0.687299 | 0.668979 | 0.44439259808584214 |

- Results on Fine-tuned set of hyperparams

|       Model       |    Acc   | Macro F1 | Epoch |                                                                Critical Metrics                                                                |
|:-----------------:|:--------:|:--------:|:-----:|:----------------------------------------------------------------------------------------------------------------------------------------------:|
|    Baseline-GloVe | 0.705357 | 0.592138 |   12  |   {'low': [0.8624989218763476, 0.7582409250099725, 0.8069668099534251], 'high': [0.3124990234405517, 0.476188208627578, 0.37730922641803316]}  |
|     Baseline-BERT | 0.794643 | 0.627641 |   32  |   {'low': [0.854165776910649, 0.9010979108814166, 0.8769544482131985], 'high': [0.43749726564208974, 0.3333317460393046, 0.37832725253351307]}  |
|   Multitask-GloVe | 0.776786 | 0.611868 |   12  | {'low': [0.8510629244011442, 0.8791199130550406, 0.8648139459140285], 'high': [0.3888867284070644, 0.3333317460393046, 0.3589228208257999]} |
|    Mulittask-BERT | 0.758929 | 0.636444 |   29  |  {'low': [0.8720920091953381, 0.8241749184891005, 0.8474067123846547], 'high': [0.3846139053311333, 0.476188208627578, 0.425480675731441]} |
| Adversarial-GloVe | 0.839286 | 0.714719 |   14  |   {'low': [0.8842095955688467, 0.9230759087077925, 0.9031748611312709], 'high': [0.5882318339303887, 0.476188208627578, 0.526263578060859]} |
|  Adversarial-BERT | 0.812500 | 0.660015 |   {'low': [0.8645824327266326, 0.9120869097946046, 0.8876496239059914], 'high': [0.49999687501953116, 0.38095056690206236, 0.43238101360925524]}   |   {'low': [0.8348616193930097, 0.9999989011001087, 0.909949497702883], 'high': [0.9999666677777408, 0.1428564625882734, 0.2499760431292765]}   |  

#### Earthquake experiment 2
##### Data Split

train:
 - 2015_Nepal_Earthquake_en
 - 2014_Chile_Earthquake_en
 - 2012_Costa_Rica_earthquake
 - 2012_Italy_earthquakes
 
valid:
 - 2012_Guatemala_earthquake

##### Results

|       Model       |    Acc   | Macro F1 | Epoch |                                                                Critical Metrics                                                               |
|:-----------------:|:--------:|:--------:|:-----:|:---------------------------------------------------------------------------------------------------------------------------------------------:|
|    Baseline-GloVe | 0.793750 | 0.470649 |   28  |  {'low': [0.7924523317909863, 0.9999992063498362, 0.8841605789287031], 'high': [0.9999000099990001, 0.029411678200946464, 0.05713697962501]}  |
|     Baseline-BERT | 0.787500 | 0.568346 |   32  | {'low': [0.8108102629660385, 0.9523801965236536, 0.8758620945643529], 'high': [0.49999583336805525, 0.1764700692056788, 0.26082987328021817]} |
|   Multitask-GloVe | 0.800000 | 0.499187 |   29  |   {'low': [0.7974678497038926, 0.9999992063498362, 0.887273956326408], 'high': [0.9999500024998751, 0.05882335640189293, 0.111100000555554]}  |
|    Mulittask-BERT | 0.793750 | 0.538381 |   17  |  {'low': [0.8039210431888606, 0.9761897014367449, 0.881670269094232], 'high': [0.5714204082798817, 0.11764671280378586, 0.19509268682875494]} |
| Adversarial-GloVe | 0.793750 | 0.470649 |   20  |  {'low': [0.7924523317909863, 0.9999992063498362, 0.8841605789287031], 'high': [0.9999000099990001, 0.029411678200946464, 0.05713697962501]}  |
|  Adversarial-BERT | 0.743750 | 0.488693 |   38  | {'low': [0.7891151094455038, 0.9206341899728651, 0.8497665260053451], 'high': [0.23076745563495665, 0.0882350346028394, 0.12761902558633093]} |


#### Earthquake experiment 3
##### Data Split

train:
 - 2015_Nepal_Earthquake_en
 - 2014_Chile_Earthquake_en
 - 2012_Guatemala_earthquake
 - 2012_Italy_earthquakes
 
valid:
 - 2012_Costa_Rica_earthquake

##### Results

|       Model       |    Acc   | Macro F1 | Epoch |                                                                 Critical Metrics                                                                |
|:-----------------:|:--------:|:--------:|:-----:|:-----------------------------------------------------------------------------------------------------------------------------------------------:|
|    Baseline-GloVe | 0.898438 | 0.508811 |   37  | {'low': [0.9196783455107046, 0.9744676704392892, 0.9462306451823992], 'high': [0.14285510206997043, 0.047618820862757795, 0.07139058072706189]} |
|     Baseline-BERT | 0.914062 | 0.610465 |   11  | {'low': [0.9311737120754202, 0.978722987777452, 0.954306484081861], 'high': [0.4444395062277086, 0.19047528345103118, 0.266622895408111]}       |
|   Multitask-GloVe | 0.914062 | 0.519089 |   26  | {'low': [0.9209482525896234, 0.9914889397919405, 0.95486771206398], 'high': [0.33332222259258026, 0.047618820862757795, 0.08331076916690612]}   |
|    Mulittask-BERT | 0.812500 | 0.533295 |   31  | {'low': [0.9269402160090338, 0.8638294196470555, 0.894222798689928], 'high': [0.13513476990602727, 0.238094104313789, 0.17236701591680795]}     |
| Adversarial-GloVe | 0.921875 | 0.562805 |   19  | {'low': [0.9249008201973042, 0.9957442571301033, 0.9589660710289059], 'high': [0.6666444451851605, 0.09523764172551559, 0.1666434051914715]}    |
|  Adversarial-BERT | 0.914062 | 0.633285 |   30  | {'low': [0.934693496043471, 0.9744676704392892, 0.9541162934164361], 'high': [0.454541322351615, 0.238094104313789, 0.31245293615158437]}       |

#### Earthquake experiment 4
##### Data Split

train:
 - 2015_Nepal_Earthquake_en
 - 2012_Costa_Rica_earthquake
 - 2012_Guatemala_earthquake
 - 2012_Italy_earthquakes
 
valid:
- 2014_Chile_Earthquake_en

##### Results

|       Model       |    Acc   | Macro F1 | Epoch |                                                                Critical Metrics                                                                |
|:-----------------:|:--------:|:--------:|:-----:|:----------------------------------------------------------------------------------------------------------------------------------------------:|
|    Baseline-GloVe |          |          |       |                                                                                                                                                |
|     Baseline-BERT | 0.918750 | 0.545305 |   5   | {'low': [0.9636960515854616, 0.95113975532907, 0.9573267400472159], 'high': [0.11764636678607773, 0.15384497042330444, 0.13328335141013556]}   |
|   Multitask-GloVe |          |          |       |                                                                                                                                                |
|    Mulittask-BERT | 0.809375 | 0.516780 |   31  | {'low': [0.9694652788300463, 0.8273612940191225, 0.8927443777823896], 'high': [0.08620674791940014, 0.38461242605826107, 0.14081476521678538]} |
| Adversarial-GloVe |          |          |       |                                                                                                                                                |
|  Adversarial-BERT | 0.890625 | 0.543908 |   7   | {'low': [0.9657530939201734, 0.9185664760369786, 0.941519001762685], 'high': [0.10714247449116253, 0.23076745563495665, 0.1462974547495298]}   |
